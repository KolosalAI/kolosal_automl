<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Kolosal AutoML</title>
    <script src="/static/chart.min.js" defer></script>
    <link rel="preload" href="/static/remixicon.woff2" as="font" type="font/woff2" crossorigin>
    <link href="/static/remixicon.css" rel="stylesheet" media="print" onload="this.media='all'">
    <noscript><link href="/static/remixicon.css" rel="stylesheet"></noscript>
    <style>
        /* === Reset === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-variation-settings: "slnt" 0;
            font-optical-sizing: auto;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            font-smooth: never;
            scrollbar-width: none;
            font-family: "Inter", sans-serif;
        }
        h1, h2, h3, h4, h5, h6, small, p, span, a { margin: 0; padding: 0; text-shadow: none; }
        body { -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; scrollbar-width: none; }
        body::-webkit-scrollbar { display: none; }
        body img { display: block; }

        /* === Color Variables === */
        :root {
            --color-text-900: #0D0E0F;
            --color-text-800: #3C3E40;
            --color-text-700: #6A6F73;
            --color-text-600: #9C9FA1;
            --color-text-500: #CECFD0;
            --color-grey-900: #DDE1E3;
            --color-grey-800: #E4E7E9;
            --color-grey-700: #EBEDEE;
            --color-grey-600: #F1F3F4;
            --color-grey-500: #F8F9F9;
            --color-information-900: #001431;
            --color-information-800: #002962;
            --color-information-700: #003D93;
            --color-information-600: #0052C4;
            --color-information-500: #0066F5;
            --color-information-400: #3C8AF7;
            --color-information-300: #78AEFA;
            --color-information-200: #B4D2FC;
            --color-information-100: #F0F6FE;
            --color-success-900: #0C260D;
            --color-success-800: #174B19;
            --color-success-700: #237126;
            --color-success-600: #2E9632;
            --color-success-500: #3ABC3F;
            --color-success-400: #68CC6C;
            --color-success-300: #97DC99;
            --color-success-200: #C5EBC6;
            --color-success-100: #F3FBF4;
            --color-danger-900: #330A0A;
            --color-danger-800: #661414;
            --color-danger-700: #991D1D;
            --color-danger-600: #CC2727;
            --color-danger-500: #FF3131;
            --color-danger-400: #FF6161;
            --color-danger-300: #FF9292;
            --color-danger-200: #FFC2C2;
            --color-danger-100: #FFF3F3;
            --color-warning-900: #33220A;
            --color-warning-800: #664414;
            --color-warning-700: #99651D;
            --color-warning-600: #CC8727;
            --color-warning-500: #FFA931;
            --color-warning-400: #FFBD61;
            --color-warning-300: #FFD192;
            --color-warning-200: #FFE6C2;
            --color-warning-100: #FFFAF3;
        }

        /* === Typography === */
        .text-12px { font-size: 12px; line-height: 16px; letter-spacing: -0.2px; font-family: "Inter", sans-serif; }
        .text-14px { font-size: 14px; line-height: 20px; letter-spacing: -0.2px; font-family: "Inter", sans-serif; }
        .text-16px { font-size: 16px; line-height: 24px; letter-spacing: -0.2px; font-family: "Inter", sans-serif; }
        .text-18px { font-size: 18px; line-height: 28px; letter-spacing: -0.2px; font-family: "Inter", sans-serif; }
        .text-20px { font-size: 20px; line-height: 32px; letter-spacing: -0.2px; font-family: "Inter", sans-serif; }
        .text-24px { font-size: 24px; line-height: 36px; letter-spacing: 0px; font-family: "Inter", sans-serif; }
        .text-32px { font-size: 32px; line-height: 44px; letter-spacing: -0.6px; font-family: "Inter", sans-serif; }
        .mono-12px { font-size: 12px; line-height: 16px; letter-spacing: -0.4px; font-family: "Geist Mono", monospace; }
        .mono-14px { font-size: 14px; line-height: 20px; letter-spacing: -0.4px; font-family: "Geist Mono", monospace; }
        .mono-20px { font-size: 20px; line-height: 32px; letter-spacing: -0.4px; font-family: "Geist Mono", monospace; }
        .mono-32px { font-size: 32px; line-height: 44px; letter-spacing: -0.8px; font-family: "Geist Mono", monospace; }
        .reguler { font-weight: 400; font-style: normal; }
        .medium { font-weight: 500; font-style: normal; }

        /* === Layout === */
        .container { max-width: 1080px; width: 100%; padding-left: 20px; padding-right: 20px; margin-left: auto; margin-right: auto; }
        .container-fluid { max-width: 100%; width: 100%; margin-left: auto; margin-right: auto; }
        .col-fill { flex: 1 0 0; }

        /* === Buttons === */
        .btn-xs { display: flex; flex-direction: row; justify-content: center; align-items: center; gap: 4px; height: 28px; font-size: 12px; font-weight: 500; line-height: 16px; letter-spacing: 0.3px; border-radius: 6px; outline: none; border: none; padding-left: 8px; padding-right: 8px; text-decoration: none; cursor: pointer; }
        .btn-xs i { font-size: 14px; }
        .btn-sm { display: flex; flex-direction: row; justify-content: center; align-items: center; gap: 4px; height: 32px; font-size: 14px; font-weight: 500; line-height: 20px; letter-spacing: 0.3px; border-radius: 8px; outline: none; border: none; padding-left: 10px; padding-right: 10px; text-decoration: none; cursor: pointer; }
        .btn-sm i { font-size: 16px; }
        .btn-md { display: flex; flex-direction: row; justify-content: center; align-items: center; gap: 6px; height: 36px; font-size: 14px; font-weight: 500; line-height: 20px; letter-spacing: 0.3px; border-radius: 10px; outline: none; border: none; padding-left: 14px; padding-right: 14px; text-decoration: none; cursor: pointer; }
        .btn-md i { font-size: 20px; }
        .btn-lg { display: flex; flex-direction: row; justify-content: center; align-items: center; gap: 8px; height: 40px; font-size: 14px; font-weight: 500; line-height: 20px; letter-spacing: 0.3px; border-radius: 12px; outline: none; border: none; padding-left: 16px; padding-right: 16px; text-decoration: none; cursor: pointer; }
        .btn-lg i { font-size: 24px; }
        .btn-sm-icon { display: flex; flex-direction: row; justify-content: center; align-items: center; height: 32px; width: 32px; border-radius: 8px; outline: none; border: none; text-decoration: none; cursor: pointer; }
        .btn-sm-icon i { font-size: 16px; }
        .btn-primary { background-color: var(--color-text-900); color: #FFFFFF; box-shadow: inset 0px 2px 0px 0px rgba(255,255,255,0.25); border: 1px solid var(--color-text-900); }
        .btn-primary:hover { background: linear-gradient(90deg, #0D0E0F, #FF3131, #0066F5); background-size: 300% 300%; animation: gradientMove 3s ease infinite; }
        @keyframes gradientMove { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .btn-secondary { background-color: var(--color-information-500); color: #FFFFFF; box-shadow: inset 0px 2px 0px 0px rgba(255,255,255,0.25); border: 1px solid var(--color-information-500); }
        .btn-secondary:hover { background-color: var(--color-information-600); border-color: var(--color-information-600); }
        .btn-outline { background-color: #FFFFFF; border: 1px solid var(--color-grey-800); box-shadow: 0px 3px 4px -4px rgba(0,0,0,0.15); color: var(--color-text-900); }
        .btn-outline:hover { background-color: var(--color-grey-500); border: 1px solid var(--color-grey-900); }
        .btn-danger { background-color: var(--color-danger-500); border: 1px solid var(--color-danger-500); color: #FFFFFF; box-shadow: inset 0px 2px 0px 0px rgba(255,255,255,0.25); }
        .btn-danger:hover { background-color: var(--color-danger-600); border-color: var(--color-danger-600); }
        .btn-ghost { background-color: transparent; color: var(--color-text-900); border: none; }
        .btn-ghost:hover { background-color: var(--color-grey-600); }
        .btn-primary:disabled, .btn-secondary:disabled, .btn-outline:disabled, .btn-danger:disabled, .btn-ghost:disabled { pointer-events: none; opacity: 0.65; cursor: not-allowed; }

        /* === Inputs === */
        .input-text-sm { font-size: 14px; line-height: 20px; font-weight: 400; height: 32px; padding-left: 10px; padding-right: 10px; border: 1px solid var(--color-grey-900); border-radius: 8px; width: 100%; box-shadow: 0px 3px 4px -4px rgba(0,0,0,0.15); }
        .input-text-md { font-size: 14px; line-height: 20px; font-weight: 400; height: 36px; padding-left: 14px; padding-right: 14px; border: 1px solid var(--color-grey-900); border-radius: 10px; width: 100%; box-shadow: 0px 3px 4px -4px rgba(0,0,0,0.15); }
        .input-text-lg { font-size: 14px; line-height: 20px; font-weight: 400; height: 40px; padding-left: 16px; padding-right: 16px; border: 1px solid var(--color-grey-900); border-radius: 12px; width: 100%; box-shadow: 0px 3px 4px -4px rgba(0,0,0,0.15); }
        .input-text-sm:hover, .input-text-md:hover, .input-text-lg:hover { border-color: var(--color-text-500); box-shadow: none; }
        .input-text-sm::placeholder, .input-text-md::placeholder, .input-text-lg::placeholder { color: var(--color-text-600); }
        .input-text-sm:focus-visible, .input-text-md:focus-visible, .input-text-lg:focus-visible { border: 1px solid var(--color-text-600); outline: none; box-shadow: 0px 0px 0px 2px var(--color-grey-800); }
        select.input-text-sm, select.input-text-md, select.input-text-lg { appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%236A6F73' viewBox='0 0 24 24'%3E%3Cpath d='M12 16l-6-6h12z'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 12px center; padding-right: 36px; }
        .input-textarea { font-size: 14px; line-height: 24px; font-weight: 400; padding: 8px 12px; width: 100%; min-height: 156px; border: 1px solid var(--color-grey-900); box-shadow: 0px 3px 4px -4px rgba(0,0,0,0.15); border-radius: 12px; resize: none; font-family: "Inter", sans-serif; }
        .input-textarea:hover { border-color: var(--color-text-500); box-shadow: none; }
        .input-textarea::placeholder { color: var(--color-text-600); }
        .input-textarea:focus-visible { border: 1px solid var(--color-text-600); outline: none; box-shadow: 0px 0px 0px 2px var(--color-grey-800); }

        /* === Badge === */
        .badge-sm { display: flex; flex-direction: row; justify-content: center; align-items: center; height: 24px; border-radius: 6px; width: fit-content; padding: 0px 8px; font-size: 12px; font-weight: 500; line-height: 16px; }
        .badge-information { color: var(--color-information-600); background-color: var(--color-information-100); }
        .badge-success { color: var(--color-success-600); background-color: var(--color-success-100); }
        .badge-danger { color: var(--color-danger-600); background-color: var(--color-danger-100); }
        .badge-warning { color: var(--color-warning-600); background-color: var(--color-warning-100); }

        /* === Switch === */
        .switch-sm { position: relative; display: flex; align-items: center; justify-content: center; width: 28px; height: 16px; border-radius: 24px; overflow: hidden; }
        .switch-sm input { opacity: 0; width: 0; height: 0; }
        .switch-sm .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; padding: 1px; background-color: var(--color-grey-700); border: 1px solid var(--color-grey-900); border-radius: 999px; transition: all 0.25s ease; }
        .switch-sm .slider::before { content: ""; position: absolute; height: 12px; width: 12px; background-color: #FFFFFF; border-radius: 999px; box-shadow: 0 1px 2px rgba(0,0,0,0.2); transition: transform 0.4s ease, background-color 0.4s ease; }
        .switch-sm input:checked + .slider { background-color: var(--color-text-700); border-color: var(--color-text-800); }
        .switch-sm input:checked + .slider::before { background-color: var(--color-text-900); transform: translateX(12px); }

        /* === Ornament === */
        .ornament-icon-grey { display: flex; flex-direction: row; justify-content: center; align-items: center; height: 40px; width: 40px; background-color: var(--color-grey-500); border: 1px solid var(--color-grey-700); border-radius: 12px; }
        .ornament-icon-grey i { font-size: 20px; color: var(--color-text-600); }

        /* === App Layout === */
        body { background-color: var(--color-grey-500); color: var(--color-text-900); min-height: 100vh; }

        /* Header */
        .app-header { position: sticky; top: 0; z-index: 15; background-color: #FFFFFF; border-bottom: 1px solid var(--color-grey-900); }
        .app-header-inner { display: flex; flex-direction: row; justify-content: space-between; align-items: center; padding-top: 16px; padding-bottom: 16px; }
        .app-header-logo { display: flex; flex-direction: row; align-items: center; gap: 10px; }
        .app-header-logo .divider { height: 16px; border-right: 1px solid var(--color-grey-900); margin-left: 4px; margin-right: 4px; }
        .app-header-status { display: flex; flex-direction: row; align-items: center; gap: 8px; }
        .status-dot { width: 8px; height: 8px; border-radius: 999px; }
        .status-dot.healthy { background-color: var(--color-success-500); }
        .status-dot.error { background-color: var(--color-danger-500); }

        /* Navigation */
        .app-nav { background-color: #FFFFFF; border-bottom: 1px solid var(--color-grey-800); }
        .app-nav-inner { display: flex; flex-direction: row; align-items: center; gap: 4px; }
        .nav-tab { display: flex; flex-direction: row; justify-content: center; align-items: center; gap: 6px; height: 40px; padding: 0 12px; font-size: 14px; font-weight: 500; line-height: 20px; color: var(--color-text-700); background: none; border: none; border-bottom: 2px solid transparent; cursor: pointer; transition: all 0.15s ease; border-radius: 0; }
        .nav-tab:hover { color: var(--color-text-900); background-color: var(--color-grey-600); }
        .nav-tab.active { color: var(--color-text-900); border-bottom-color: var(--color-text-900); }
        .nav-tab i { font-size: 16px; }

        /* Cards */
        .card { background-color: #FFFFFF; border: 1px solid var(--color-grey-800); border-radius: 12px; padding: 24px; }
        .card-header { display: flex; flex-direction: row; justify-content: space-between; align-items: center; margin-bottom: 16px; }

        /* Grid */
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
        .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; }
        .grid-1-2 { display: grid; grid-template-columns: 1fr 2fr; gap: 16px; }
        @media (max-width: 768px) {
            .grid-2, .grid-3, .grid-1-2 { grid-template-columns: 1fr; }
        }

        /* Content area */
        .app-content { padding-top: 24px; padding-bottom: 24px; }
        .section-gap { display: flex; flex-direction: column; gap: 16px; }

        /* Dropzone */
        .dropzone { border: 2px dashed var(--color-grey-900); border-radius: 12px; padding: 40px 24px; text-align: center; cursor: pointer; transition: all 0.15s ease; }
        .dropzone:hover { border-color: var(--color-text-500); background-color: var(--color-grey-600); }
        .dropzone.drag-over { border-color: var(--color-information-500); background-color: var(--color-information-100); }
        .dropzone i { font-size: 40px; color: var(--color-text-600); margin-bottom: 12px; }

        /* Table */
        .data-table { width: 100%; border-collapse: collapse; }
        .data-table th { padding: 8px 12px; text-align: left; font-size: 12px; font-weight: 500; line-height: 16px; color: var(--color-text-700); background-color: var(--color-grey-500); border-bottom: 1px solid var(--color-grey-800); text-transform: uppercase; letter-spacing: 0.3px; }
        .data-table td { padding: 8px 12px; font-size: 14px; line-height: 20px; color: var(--color-text-800); border-bottom: 1px solid var(--color-grey-700); }
        .data-table tr:hover td { background-color: var(--color-grey-500); }
        .table-wrap { overflow-x: auto; border: 1px solid var(--color-grey-800); border-radius: 10px; }

        /* Progress bar */
        .progress-bar { width: 100%; height: 6px; background-color: var(--color-grey-800); border-radius: 999px; overflow: hidden; }
        .progress-bar-fill { height: 100%; background-color: var(--color-information-500); border-radius: 999px; transition: width 0.3s ease; }

        /* Form */
        .form-group { display: flex; flex-direction: column; gap: 6px; }
        .form-label { font-size: 14px; font-weight: 500; line-height: 20px; color: var(--color-text-800); }
        .form-hint { font-size: 12px; line-height: 16px; color: var(--color-text-600); }
        .form-stack { display: flex; flex-direction: column; gap: 20px; }

        /* Range input */
        input[type="range"] { width: 100%; height: 6px; appearance: none; background: var(--color-grey-800); border-radius: 999px; outline: none; }
        input[type="range"]::-webkit-slider-thumb { appearance: none; width: 16px; height: 16px; border-radius: 999px; background: var(--color-text-900); cursor: pointer; border: 2px solid #FFFFFF; box-shadow: 0 1px 3px rgba(0,0,0,0.2); }

        /* Checkbox */
        .checkbox-row { display: flex; flex-direction: row; align-items: center; gap: 10px; cursor: pointer; padding: 6px 0; }
        .checkbox-row input[type="checkbox"] { width: 16px; height: 16px; accent-color: var(--color-text-900); cursor: pointer; }

        /* Stat card */
        .stat-value { font-size: 32px; line-height: 44px; letter-spacing: -0.6px; font-family: "Geist Mono", monospace; font-weight: 500; }
        .stat-value.info { color: var(--color-information-500); }
        .stat-value.success { color: var(--color-success-500); }

        /* Job card */
        .job-card { border: 1px solid var(--color-grey-800); border-radius: 10px; padding: 16px; display: flex; flex-direction: column; gap: 10px; }

        /* Pre/Code */
        .code-block { background-color: var(--color-grey-500); border: 1px solid var(--color-grey-800); border-radius: 10px; padding: 16px; font-size: 13px; line-height: 20px; font-family: "Geist Mono", monospace; overflow: auto; color: var(--color-text-800); }

        /* Toast notifications */
        .toast-container { position: fixed; bottom: 20px; right: 20px; display: flex; flex-direction: column; gap: 8px; z-index: 100; }
        .toast { padding: 10px 16px; border-radius: 10px; font-size: 14px; font-weight: 500; line-height: 20px; box-shadow: 0px 4px 12px rgba(0,0,0,0.15); }
        .toast-success { background-color: var(--color-success-500); color: #FFFFFF; }
        .toast-error { background-color: var(--color-danger-500); color: #FFFFFF; }
        .toast-info { background-color: var(--color-text-900); color: #FFFFFF; }

        /* Sample dataset pills */
        .pill { display: inline-flex; align-items: center; height: 28px; padding: 0 10px; font-size: 12px; font-weight: 500; border-radius: 999px; border: none; cursor: pointer; transition: all 0.15s ease; background-color: var(--color-information-100); color: var(--color-information-600); }
        .pill:hover { background-color: var(--color-information-200); }

        /* Separator */
        .separator { border: none; border-top: 1px solid var(--color-grey-800); margin: 4px 0; }

        /* Empty state */
        .empty-state { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 40px 20px; color: var(--color-text-600); gap: 8px; }
        .empty-state i { font-size: 32px; color: var(--color-text-500); }

        /* Utility */
        .w-full { width: 100%; }
        .hidden { display: none; }
        .flex-row { display: flex; flex-direction: row; }
        .flex-col { display: flex; flex-direction: column; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-4 { gap: 4px; }
        .gap-6 { gap: 6px; }
        .gap-8 { gap: 8px; }
        .gap-12 { gap: 12px; }
        .gap-16 { gap: 16px; }
        .gap-24 { gap: 24px; }
        .flex-wrap { flex-wrap: wrap; }
        .text-center { text-align: center; }
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }
    </style>
</head>
<body style="background-color:#F8F9F9;color:#0D0E0F;font-family:Inter,system-ui,-apple-system,sans-serif;margin:0;padding:0;min-height:100vh;display:block;visibility:visible;opacity:1;">
    <!-- Header -->
    <header class="app-header">
        <div class="container app-header-inner">
            <div class="app-header-logo">
                <i class="ri-brain-line" style="font-size: 24px; color: var(--color-text-900);"></i>
                <span class="mono-20px medium">Kolosal AutoML</span>
                <div class="divider"></div>
                <span class="text-14px reguler" style="color: var(--color-text-700);">Rust-Powered</span>
            </div>
            <div class="app-header-status">
                <div id="status-badge" class="badge-sm badge-success">healthy</div>
                <div id="status-dot" class="status-dot healthy"></div>
            </div>
        </div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="app-nav">
        <div class="container app-nav-inner">
            <button class="nav-tab active" onclick="switchTab('data')" data-tab="data">
                <i class="ri-folder-upload-line"></i> Data
            </button>
            <button class="nav-tab" onclick="switchTab('config')" data-tab="config">
                <i class="ri-settings-3-line"></i> Config
            </button>
            <button class="nav-tab" onclick="switchTab('training')" data-tab="training">
                <i class="ri-rocket-line"></i> Training
            </button>
            <button class="nav-tab" onclick="switchTab('compare')" data-tab="compare">
                <i class="ri-bar-chart-grouped-line"></i> Compare
            </button>
            <button class="nav-tab" onclick="switchTab('predict')" data-tab="predict">
                <i class="ri-magic-line"></i> Predict
            </button>
            <button class="nav-tab" onclick="switchTab('monitor')" data-tab="monitor">
                <i class="ri-dashboard-3-line"></i> Monitor
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container app-content">
        <noscript>
            <div class="card" style="text-align: center; padding: 40px;">
                <p class="text-16px medium" style="color: var(--color-text-800);">JavaScript is required to use Kolosal AutoML.</p>
                <p class="text-14px reguler" style="color: var(--color-text-700); margin-top: 8px;">Please enable JavaScript in your browser settings.</p>
            </div>
        </noscript>

        <!-- Data Upload Tab -->
        <div id="tab-data" class="tab-panel active">
            <div class="grid-2">
                <div class="card">
                    <div class="card-header">
                        <h2 class="text-16px medium">Upload Data</h2>
                    </div>
                    <div id="dropzone" class="dropzone">
                        <input type="file" id="fileInput" accept=".csv,.json,.parquet" class="hidden">
                        <i class="ri-upload-cloud-2-line"></i>
                        <p class="text-14px reguler" style="color: var(--color-text-800);">Drop your CSV, JSON, or Parquet file here</p>
                        <p class="text-12px reguler" style="color: var(--color-text-600); margin-top: 4px;">or click to browse</p>
                    </div>
                    <div style="margin-top: 20px;">
                        <p class="text-12px medium" style="color: var(--color-text-700); margin-bottom: 8px;">Or load a sample dataset:</p>
                        <div id="sample-pills" class="flex-row flex-wrap gap-8"></div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h2 class="text-16px medium">Data Preview</h2>
                        <div id="data-meta" class="flex-row items-center gap-12" style="display:none;">
                            <span class="text-12px reguler" style="color: var(--color-text-700);">
                                <span id="data-rows">0</span> rows &times; <span id="data-cols">0</span> columns
                            </span>
                            <button onclick="refreshPreview()" class="btn-xs btn-ghost"><i class="ri-refresh-line"></i> Refresh</button>
                        </div>
                    </div>
                    <div id="preview-table" style="display:none;"></div>
                    <div id="preview-empty" class="empty-state">
                        <i class="ri-database-2-line"></i>
                        <p class="text-14px reguler">No data loaded</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Configuration Tab -->
        <div id="tab-config" class="tab-panel">
            <div class="card" style="max-width: 600px;">
                <div class="card-header">
                    <h2 class="text-16px medium">Training Configuration</h2>
                </div>
                <div class="form-stack">
                    <div class="form-group">
                        <label class="form-label">Task Type</label>
                        <select id="cfg-taskType" class="input-text-md">
                            <option value="classification">Classification</option>
                            <option value="regression">Regression</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Target Column</label>
                        <select id="cfg-targetColumn" class="input-text-md">
                            <option value="">Select target...</option>
                        </select>
                    </div>
                    <hr class="separator">
                    <div class="form-group">
                        <label class="form-label">Preprocessing</label>
                        <div class="grid-2">
                            <div class="form-group">
                                <label class="form-hint">Scaler</label>
                                <select id="cfg-scaler" class="input-text-sm">
                                    <option value="none">None</option>
                                    <option value="standard" selected>Standard</option>
                                    <option value="minmax">MinMax</option>
                                    <option value="robust">Robust</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-hint">Missing Values</label>
                                <select id="cfg-imputation" class="input-text-sm">
                                    <option value="drop">Drop</option>
                                    <option value="mean" selected>Mean</option>
                                    <option value="median">Median</option>
                                    <option value="mode">Mode</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">
                            Cross-Validation Folds: <span id="cv-folds-display" class="mono-14px">5</span>
                        </label>
                        <input type="range" id="cfg-cvFolds" min="2" max="10" value="5" oninput="document.getElementById('cv-folds-display').textContent=this.value">
                    </div>
                    <button id="btn-preprocess" onclick="applyPreprocessing()" class="btn-md btn-primary w-full" disabled>
                        <i class="ri-check-line"></i> Apply Preprocessing
                    </button>
                </div>
            </div>
        </div>

        <!-- Training Tab -->
        <div id="tab-training" class="tab-panel">
            <div class="grid-1-2">
                <div class="card">
                    <div class="card-header">
                        <h2 class="text-16px medium">Select Models</h2>
                    </div>
                    <div id="model-checkboxes" class="flex-col gap-4"></div>
                    <button id="btn-train" onclick="startTraining()" class="btn-md btn-primary w-full" style="margin-top: 20px;" disabled>
                        <i class="ri-rocket-line"></i> Start Training
                    </button>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h2 class="text-16px medium">Training Progress</h2>
                    </div>
                    <div id="jobs-list"></div>
                    <div id="jobs-empty" class="empty-state">
                        <i class="ri-flask-line"></i>
                        <p class="text-14px reguler">No training jobs yet</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Compare Tab -->
        <div id="tab-compare" class="tab-panel">
            <div class="card">
                <div class="card-header">
                    <h2 class="text-16px medium">Model Comparison</h2>
                    <button id="btn-compare" onclick="compareAllModels()" class="btn-sm btn-primary" disabled>
                        <i class="ri-bar-chart-grouped-line"></i> Compare All Models
                    </button>
                </div>
                <div id="compare-results" style="display:none;">
                    <div class="flex-col gap-24">
                        <div id="compare-table-wrap" class="table-wrap"></div>
                        <div style="max-height: 300px;">
                            <canvas id="comparisonChart" width="400" height="200"></canvas>
                        </div>
                    </div>
                </div>
                <div id="compare-empty" class="empty-state">
                    <i class="ri-bar-chart-grouped-line"></i>
                    <p class="text-14px reguler">Run a comparison to see results</p>
                </div>
            </div>
        </div>

        <!-- Predict Tab -->
        <div id="tab-predict" class="tab-panel">
            <div class="grid-2">
                <div class="card">
                    <div class="card-header">
                        <h2 class="text-16px medium">Input Data</h2>
                    </div>
                    <div class="form-stack">
                        <textarea id="prediction-input" class="input-textarea" placeholder="Enter values as JSON or comma-separated..."></textarea>
                        <button onclick="makePrediction()" class="btn-md btn-primary w-full">
                            <i class="ri-magic-line"></i> Predict
                        </button>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h2 class="text-16px medium">Predictions</h2>
                    </div>
                    <div id="prediction-output"></div>
                    <div id="prediction-empty" class="empty-state">
                        <i class="ri-magic-line"></i>
                        <p class="text-14px reguler">No predictions yet</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Monitor Tab -->
        <div id="tab-monitor" class="tab-panel">
            <div class="section-gap">
                <div class="grid-3">
                    <div class="card">
                        <p class="text-12px medium" style="color: var(--color-text-700); margin-bottom: 8px;">CPU Usage</p>
                        <p id="mon-cpu" class="stat-value info">0.0%</p>
                    </div>
                    <div class="card">
                        <p class="text-12px medium" style="color: var(--color-text-700); margin-bottom: 8px;">Memory Usage</p>
                        <p id="mon-mem" class="stat-value success">0.0%</p>
                        <p id="mon-mem-detail" class="text-12px reguler" style="color: var(--color-text-600); margin-top: 4px;">0.0 / 0.0 GB</p>
                    </div>
                    <div class="card">
                        <p class="text-12px medium" style="color: var(--color-text-700); margin-bottom: 8px;">Status</p>
                        <p id="mon-status" class="stat-value success">healthy</p>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h2 class="text-16px medium">System Overview</h2>
                        <button onclick="refreshSystemStatus()" class="btn-xs btn-ghost"><i class="ri-refresh-line"></i> Refresh</button>
                    </div>
                    <div class="grid-3" style="text-align: center;">
                        <div>
                            <p id="mon-datasets" class="mono-32px medium">0</p>
                            <p class="text-12px reguler" style="color: var(--color-text-700);">Datasets</p>
                        </div>
                        <div>
                            <p id="mon-jobs" class="mono-32px medium">0</p>
                            <p class="text-12px reguler" style="color: var(--color-text-700);">Jobs</p>
                        </div>
                        <div>
                            <p id="mon-models" class="mono-32px medium">0</p>
                            <p class="text-12px reguler" style="color: var(--color-text-700);">Models</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Toast Notifications -->
    <div id="toast-container" class="toast-container"></div>

    <script>
        // ── State ──
        var dataInfo = null;
        var dataPreview = { rows: 0, columns: [] };
        var trainingJobs = [];
        var comparisonResults = [];
        var selectedModels = [];
        var comparisonChartInstance = null;

        var sampleDatasets = [
            { id: 'iris', name: 'Iris' },
            { id: 'diabetes', name: 'Diabetes' },
            { id: 'boston', name: 'Boston' },
            { id: 'wine', name: 'Wine' },
            { id: 'breast_cancer', name: 'Breast Cancer' }
        ];

        var availableModels = [
            { id: 'logistic_regression', name: 'Logistic Regression' },
            { id: 'linear_regression', name: 'Linear Regression' },
            { id: 'decision_tree', name: 'Decision Tree' },
            { id: 'random_forest', name: 'Random Forest' }
        ];

        // ── Helpers ──
        function $(id) { return document.getElementById(id); }

        function notify(message, type) {
            type = type || 'info';
            var container = $('toast-container');
            var toast = document.createElement('div');
            toast.className = 'toast toast-' + type;
            toast.textContent = message;
            container.appendChild(toast);
            setTimeout(function() { toast.remove(); }, 3000);
        }

        function escHtml(s) {
            var d = document.createElement('div');
            d.textContent = s;
            return d.innerHTML;
        }

        // ── Tabs ──
        function switchTab(name) {
            var panels = document.querySelectorAll('.tab-panel');
            for (var i = 0; i < panels.length; i++) panels[i].classList.remove('active');
            var tabs = document.querySelectorAll('.nav-tab');
            for (var i = 0; i < tabs.length; i++) tabs[i].classList.remove('active');
            $('tab-' + name).classList.add('active');
            document.querySelector('[data-tab="' + name + '"]').classList.add('active');
        }

        // ── File Upload ──
        function setupDropzone() {
            var dz = $('dropzone');
            var fi = $('fileInput');
            dz.addEventListener('click', function() { fi.click(); });
            dz.addEventListener('dragover', function(e) { e.preventDefault(); dz.classList.add('drag-over'); });
            dz.addEventListener('dragleave', function() { dz.classList.remove('drag-over'); });
            dz.addEventListener('drop', function(e) {
                e.preventDefault();
                dz.classList.remove('drag-over');
                var file = e.dataTransfer.files[0];
                if (file) uploadFile(file);
            });
            fi.addEventListener('change', function(e) {
                if (e.target.files[0]) uploadFile(e.target.files[0]);
            });
        }

        function uploadFile(file) {
            var formData = new FormData();
            formData.append('file', file);
            fetch('/api/data/upload', { method: 'POST', body: formData })
                .then(function(r) { return r.json(); })
                .then(function(data) {
                    if (data.success) {
                        dataInfo = data;
                        updateDataUI();
                        refreshPreview();
                        notify('Data uploaded successfully!', 'success');
                    } else {
                        notify(data.message || 'Upload failed', 'error');
                    }
                })
                .catch(function(e) { notify('Upload failed: ' + e.message, 'error'); });
        }

        // ── Sample Datasets ──
        function setupSamplePills() {
            var container = $('sample-pills');
            sampleDatasets.forEach(function(s) {
                var btn = document.createElement('button');
                btn.className = 'pill';
                btn.textContent = s.name;
                btn.onclick = function() { loadSampleData(s.id); };
                container.appendChild(btn);
            });
        }

        function loadSampleData(name) {
            fetch('/api/data/sample/' + name)
                .then(function(r) { return r.json(); })
                .then(function(data) {
                    if (data.success) {
                        dataInfo = data;
                        updateDataUI();
                        refreshPreview();
                        notify('Loaded ' + name + ' dataset!', 'success');
                    }
                })
                .catch(function(e) { notify('Failed to load sample: ' + e.message, 'error'); });
        }

        // ── Data UI Updates ──
        function updateDataUI() {
            if (dataInfo) {
                $('data-meta').style.display = '';
                $('data-rows').textContent = dataInfo.rows || 0;
                $('data-cols').textContent = dataInfo.columns || 0;
                $('preview-empty').style.display = 'none';
                $('btn-preprocess').disabled = false;
                updateTargetOptions();
                updateTrainButton();
                $('btn-compare').disabled = !getConfig().targetColumn;
            }
        }

        function updateTargetOptions() {
            var sel = $('cfg-targetColumn');
            var names = (dataInfo && dataInfo.column_names) || [];
            sel.innerHTML = '<option value="">Select target...</option>';
            names.forEach(function(n) {
                var opt = document.createElement('option');
                opt.value = n;
                opt.textContent = n;
                sel.appendChild(opt);
            });
        }

        function refreshPreview() {
            fetch('/api/data/preview?rows=10')
                .then(function(r) { return r.json(); })
                .then(function(data) {
                    dataPreview = data;
                    renderPreviewTable();
                })
                .catch(function(e) { console.error('Preview failed:', e); });
        }

        function renderPreviewTable() {
            var cols = dataPreview.columns || [];
            var rows = dataPreview.rows || 0;
            if (cols.length === 0) { $('preview-table').style.display = 'none'; return; }

            var html = '<div class="table-wrap"><table class="data-table"><thead><tr>';
            cols.forEach(function(c) { html += '<th>' + escHtml(c.name) + '</th>'; });
            html += '</tr></thead><tbody>';
            for (var r = 0; r < rows; r++) {
                html += '<tr>';
                cols.forEach(function(c) {
                    var val = (c.values && c.values[r] != null) ? c.values[r] : '';
                    html += '<td>' + escHtml(String(val)) + '</td>';
                });
                html += '</tr>';
            }
            html += '</tbody></table></div>';
            $('preview-table').innerHTML = html;
            $('preview-table').style.display = '';
        }

        // ── Config ──
        function getConfig() {
            return {
                taskType: $('cfg-taskType').value,
                targetColumn: $('cfg-targetColumn').value,
                scaler: $('cfg-scaler').value,
                imputation: $('cfg-imputation').value,
                cvFolds: parseInt($('cfg-cvFolds').value)
            };
        }

        function applyPreprocessing() {
            var cfg = getConfig();
            fetch('/api/preprocess', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ scaler: cfg.scaler, imputation: cfg.imputation })
            })
            .then(function(r) { return r.json(); })
            .then(function(data) {
                if (data.success) {
                    refreshPreview();
                    notify('Preprocessing applied!', 'success');
                }
            })
            .catch(function(e) { notify('Preprocessing failed: ' + e.message, 'error'); });
        }

        // ── Model Selection ──
        function setupModelCheckboxes() {
            var container = $('model-checkboxes');
            availableModels.forEach(function(m) {
                var label = document.createElement('label');
                label.className = 'checkbox-row';
                var cb = document.createElement('input');
                cb.type = 'checkbox';
                cb.value = m.id;
                cb.onchange = function() {
                    if (cb.checked) {
                        if (selectedModels.indexOf(m.id) === -1) selectedModels.push(m.id);
                    } else {
                        selectedModels = selectedModels.filter(function(x) { return x !== m.id; });
                    }
                    updateTrainButton();
                };
                var span = document.createElement('span');
                span.className = 'text-14px reguler';
                span.textContent = m.name;
                label.appendChild(cb);
                label.appendChild(span);
                container.appendChild(label);
            });
        }

        function updateTrainButton() {
            var cfg = getConfig();
            $('btn-train').disabled = selectedModels.length === 0 || !cfg.targetColumn;
        }

        // ── Training ──
        function startTraining() {
            var cfg = getConfig();
            selectedModels.forEach(function(modelId) {
                fetch('/api/train', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        target_column: cfg.targetColumn,
                        task_type: cfg.taskType,
                        model_type: modelId,
                        cv_folds: cfg.cvFolds
                    })
                })
                .then(function(r) { return r.json(); })
                .then(function(data) {
                    if (data.success) {
                        trainingJobs.push({
                            id: data.job_id,
                            model_type: modelId,
                            status: { Running: { progress: 0, message: 'Starting...' } }
                        });
                        renderJobs();
                        notify('Training started for ' + modelId, 'info');
                    }
                })
                .catch(function(e) { notify('Training failed: ' + e.message, 'error'); });
            });
        }

        function renderJobs() {
            var container = $('jobs-list');
            if (trainingJobs.length === 0) {
                container.innerHTML = '';
                $('jobs-empty').style.display = '';
                return;
            }
            $('jobs-empty').style.display = 'none';
            var html = '<div class="flex-col gap-12">';
            trainingJobs.forEach(function(job) {
                var statusKey = Object.keys(job.status)[0];
                var badgeClass = statusKey === 'Running' ? 'badge-warning' : statusKey === 'Completed' ? 'badge-success' : 'badge-danger';
                html += '<div class="job-card">';
                html += '<div class="flex-row justify-between items-center">';
                html += '<span class="text-14px medium">' + escHtml(job.model_type || 'Training') + '</span>';
                html += '<span class="badge-sm ' + badgeClass + '">' + escHtml(statusKey) + '</span>';
                html += '</div>';
                if (job.status.Running) {
                    var pct = (job.status.Running.progress * 100).toFixed(0);
                    html += '<div class="flex-col gap-6">';
                    html += '<div class="progress-bar"><div class="progress-bar-fill" style="width:' + pct + '%"></div></div>';
                    html += '<p class="text-12px reguler" style="color:var(--color-text-700);">' + escHtml(job.status.Running.message || '') + '</p>';
                    html += '</div>';
                }
                if (job.status.Completed) {
                    html += '<div class="flex-col gap-4">';
                    var metrics = job.status.Completed.metrics || {};
                    Object.keys(metrics).forEach(function(k) {
                        var v = metrics[k];
                        var display = typeof v === 'number' ? v.toFixed(4) : JSON.stringify(v);
                        html += '<p class="text-12px reguler" style="color:var(--color-text-700);"><strong>' + escHtml(k) + ':</strong> <span class="mono-12px">' + escHtml(display) + '</span></p>';
                    });
                    html += '</div>';
                }
                if (job.status.Failed) {
                    html += '<p class="text-12px reguler" style="color:var(--color-danger-500);">' + escHtml(job.status.Failed.error || 'Unknown error') + '</p>';
                }
                html += '</div>';
            });
            html += '</div>';
            container.innerHTML = html;
        }

        function pollJobs() {
            trainingJobs.forEach(function(job) {
                if (job.status.Completed || job.status.Failed) return;
                fetch('/api/train/status/' + job.id)
                    .then(function(r) { return r.json(); })
                    .then(function(data) {
                        job.status = data.status;
                        renderJobs();
                    })
                    .catch(function() {});
            });
        }

        // ── Compare ──
        function compareAllModels() {
            var cfg = getConfig();
            var models = cfg.taskType === 'classification'
                ? ['logistic_regression', 'decision_tree', 'random_forest']
                : ['linear_regression', 'decision_tree', 'random_forest'];

            fetch('/api/train/compare', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    target_column: cfg.targetColumn,
                    task_type: cfg.taskType,
                    models: models,
                    cv_folds: cfg.cvFolds
                })
            })
            .then(function(r) { return r.json(); })
            .then(function(data) {
                if (data.success) {
                    comparisonResults = data.comparison;
                    renderComparison();
                    notify('Comparison complete!', 'success');
                }
            })
            .catch(function(e) { notify('Comparison failed: ' + e.message, 'error'); });
        }

        function renderComparison() {
            if (comparisonResults.length === 0) {
                $('compare-results').style.display = 'none';
                $('compare-empty').style.display = '';
                return;
            }
            $('compare-empty').style.display = 'none';
            $('compare-results').style.display = '';

            var cfg = getConfig();
            var html = '<table class="data-table"><thead><tr><th>Model</th><th>Score</th><th>Std Dev</th></tr></thead><tbody>';
            comparisonResults.forEach(function(r) {
                var score = (r.metrics.accuracy || r.metrics.r2 || 0).toFixed(4);
                var std = (r.metrics.std || 0).toFixed(4);
                html += '<tr><td><span class="text-14px medium">' + escHtml(r.model) + '</span></td>';
                html += '<td><span class="mono-14px">' + score + '</span></td>';
                html += '<td><span class="mono-14px">' + std + '</span></td></tr>';
            });
            html += '</tbody></table>';
            $('compare-table-wrap').innerHTML = html;

            // Render chart
            var ctx = $('comparisonChart');
            if (!ctx || typeof Chart === 'undefined') return;
            if (comparisonChartInstance) comparisonChartInstance.destroy();
            comparisonChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: comparisonResults.map(function(r) { return r.model; }),
                    datasets: [{
                        label: cfg.taskType === 'classification' ? 'Accuracy' : 'R²',
                        data: comparisonResults.map(function(r) { return r.metrics.accuracy || r.metrics.r2 || 0; }),
                        backgroundColor: 'rgba(0, 102, 245, 0.15)',
                        borderColor: '#0066F5',
                        borderWidth: 1,
                        borderRadius: 6
                    }]
                },
                options: {
                    scales: {
                        y: { beginAtZero: true, max: 1 },
                        x: { grid: { display: false } }
                    },
                    plugins: {
                        legend: { labels: { font: { family: '"Inter", sans-serif' } } }
                    }
                }
            });
        }

        // ── Predict ──
        function makePrediction() {
            var input = $('prediction-input').value;
            fetch('/api/predict', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ data: input })
            })
            .then(function(r) { return r.json(); })
            .then(function(data) {
                $('prediction-empty').style.display = 'none';
                $('prediction-output').innerHTML = '<pre class="code-block">' + escHtml(JSON.stringify(data, null, 2)) + '</pre>';
            })
            .catch(function(e) { notify('Prediction failed: ' + e.message, 'error'); });
        }

        // ── Monitor ──
        function refreshSystemStatus() {
            fetch('/api/system/status')
                .then(function(r) { return r.json(); })
                .then(function(data) {
                    var sys = data.system || {};
                    var status = data.status || 'error';
                    $('status-badge').textContent = status;
                    $('status-badge').className = 'badge-sm ' + (status === 'healthy' ? 'badge-success' : 'badge-danger');
                    $('status-dot').className = 'status-dot ' + (status === 'healthy' ? 'healthy' : 'error');
                    $('mon-cpu').textContent = (sys.cpu_usage || 0).toFixed(1) + '%';
                    $('mon-mem').textContent = (sys.memory_usage_percent || 0).toFixed(1) + '%';
                    $('mon-mem-detail').textContent = (sys.used_memory_gb || 0).toFixed(1) + ' / ' + (sys.total_memory_gb || 0).toFixed(1) + ' GB';
                    $('mon-status').textContent = status;
                    $('mon-datasets').textContent = data.datasets_count || 0;
                    $('mon-jobs').textContent = data.jobs_count || 0;
                    $('mon-models').textContent = data.models_count || 0;
                })
                .catch(function() {
                    $('status-badge').textContent = 'error';
                    $('status-badge').className = 'badge-sm badge-danger';
                    $('status-dot').className = 'status-dot error';
                    $('mon-status').textContent = 'error';
                });
        }

        // ── Init ──
        document.addEventListener('DOMContentLoaded', function() {
            try {
                setupDropzone();
                setupSamplePills();
                setupModelCheckboxes();
                refreshSystemStatus();
                setInterval(pollJobs, 2000);

                $('cfg-targetColumn').addEventListener('change', function() {
                    updateTrainButton();
                    $('btn-compare').disabled = !this.value;
                });
            } catch (e) {
                console.error('Init error:', e);
            }
        });
    </script>
</body>
</html>
